<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Landa Quantum – Troubleshoot Suite (V20)</title>

  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'%3E%3Crect x='4' y='4' width='32' height='32' rx='9' fill='%2305090b' stroke='%23ffffff15'/%3E%3Ccircle cx='20' cy='20' r='9' fill='%2300aeef'/%3E%3C/svg%3E">
  <link rel="stylesheet" href="style.css">
</head>

<body>
<canvas id="particles"></canvas>
<div class="toast-wrap" id="toasts"></div>

<!-- LOGIN -->
<section id="loginPage">
  <div class="auth panel center">
    <div class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 360 110">
        <defs>
          <linearGradient id="lg-login" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#00aeef" />
            <stop offset="100%" stop-color="#3bd0ff" />
          </linearGradient>
        </defs>
        <text x="50%" y="52%" text-anchor="middle" fill="url(#lg-login)"
              font-family="Segoe UI, Inter, system-ui, sans-serif"
              font-weight="700" font-size="56">Landa</text>
        <text x="50%" y="82%" text-anchor="middle" fill="#9bb0d0"
              font-family="Segoe UI, Inter, system-ui, sans-serif"
              font-size="18" letter-spacing="2">Digital Printing</text>
      </svg>
      <div class="subtitle">Quantum Troubleshoot Suite</div>
    </div>
    <h2>Sign in to continue</h2>

    <label class="label" for="authUser">Username</label>
    <input class="input" id="authUser" autocomplete="username">

    <label class="label" for="authPass">Password</label>
    <input class="input" id="authPass" type="password" autocomplete="current-password">

    <!-- ריווח מהסיסמה -->
    <div style="height:12px"></div>
    <button class="btn primary full" id="btnLogin">Login</button>
  </div>
</section>

<!-- APP -->
<div class="app hidden" id="appRoot">
  <header class="header">
    <div class="header-left">
      <div class="header-title" id="logoHome">
        <div class="mark">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40">
            <defs>
              <linearGradient id="g2-header" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#00aeef"/>
                <stop offset="100%" stop-color="#3bd0ff"/>
              </linearGradient>
            </defs>
            <rect x="4" y="4" width="32" height="32" rx="9" fill="#050608" stroke="rgba(255,255,255,.08)"/>
            <circle cx="20" cy="20" r="9" fill="url(#g2-header)"/>
          </svg>
        </div>
        <div class="header-text">
          <h1>Landa Quantum – Troubleshoot Suite</h1>
          <span>Case Management & Root Cause Intelligence</span>
        </div>
      </div>
    </div>
    <div class="header-right">
      <span class="badge-env">V20 · Next Level</span>
      <span class="user-pill">
        <span class="dot"></span>
        Expert
      </span>
    </div>
  </header>

  <div class="wrap">
    <aside class="aside" id="aside">
      <nav class="nav">
        <div class="nav-section-label">Navigation</div>
        <a class="item active" data-route="dashboard">
          <span>Dashboard</span>
        </a>
        <a class="item" data-route="create">
          <span>Create Case</span>
        </a>
        <a class="item" data-route="cases">
          <span>All Cases</span>
          <span class="badge" id="casesCount">0</span>
        </a>
        <a class="item" data-route="diagnosis">
          <span>Root Cause Analyzer</span>
        </a>
        <a class="item" data-route="settings">
          <span>Settings</span>
        </a>

        <div class="nav-section-label">Session</div>
        <a class="item" id="btnLogout">
          <span>Logout</span>
        </a>
      </nav>

      <div class="nav-create-wrap">
        <button class="btn primary full" id="btnNavCreateCase">+ Create Case</button>
      </div>
    </aside>

    <main class="main">
      <!-- ========== DASHBOARD ========== -->
      <section id="page-dashboard" class="page">
        <div class="page-header">
          <div>
            <h2>Operations Overview</h2>
            <p>Data-driven view of all handled troubleshooting cases.</p>
          </div>
        </div>

        <!-- KPIs -->
        <div class="grid cols-4 kpi-row">
          <div class="panel kpi-card" data-kpi="total">
            <div class="kpi-label">Total Cases</div>
            <div class="kpi-value" id="kpiTotal">0</div>
            <div class="kpi-foot">All recorded cases</div>
          </div>

          <div class="panel kpi-card" data-kpi="closed">
            <div class="kpi-label">Closed</div>
            <div class="kpi-value" id="kpiClosed">0</div>
            <div class="kpi-foot">Successfully handled</div>
          </div>

          <div class="panel kpi-card" data-kpi="hw">
            <div class="kpi-label">HW / Mixed</div>
            <div class="kpi-value" id="kpiHW">0</div>
            <div class="kpi-foot">HW or Mixed classification</div>
          </div>

          <div class="panel kpi-card" data-kpi="regions">
            <div class="kpi-label">Active Regions</div>
            <div class="kpi-value" id="kpiRegions">0</div>
            <div class="kpi-foot">Regions with cases</div>
          </div>
        </div>

        <!-- Distributions -->
        <div class="grid cols-2">
          <div class="panel data-card">
            <div class="panel-header">
              <div>
                <div class="title">By Press Type</div>
                <div class="subtitle">Simplex vs Duplex</div>
              </div>
            </div>
            <div class="bar-list" id="dashByPressType"></div>
          </div>

          <div class="panel data-card">
            <div class="panel-header">
              <div>
                <div class="title">By Region</div>
                <div class="subtitle">Cases per region</div>
              </div>
            </div>
            <div class="bar-list" id="dashByRegion"></div>
          </div>
        </div>

        <div class="grid cols-2">
          <div class="panel data-card">
            <div class="panel-header">
              <div>
                <div class="title">By System</div>
                <div class="subtitle">Top systems by number of cases</div>
              </div>
            </div>
            <div class="bar-list" id="dashBySystem"></div>
          </div>

          <div class="panel data-card">
            <div class="panel-header">
              <div>
                <div class="title">HW / SW / EC</div>
                <div class="subtitle">Classification ratio</div>
              </div>
            </div>
            <div class="bar-list" id="dashHwSwEc"></div>
          </div>
        </div>

        <div class="panel panel-wide">
          <div class="panel-header">
            <div>
              <div class="title">Timeline</div>
              <div class="subtitle">Handled cases by quarter (Case Date)</div>
            </div>
          </div>
          <div class="timeline" id="dashTimeline"></div>
        </div>
      </section>

      <!-- ========== CREATE CASE (Cards) ========== -->
      <section id="page-create" class="page hidden">
        <div class="page-header">
          <div>
            <h2>Create Case</h2>
            <p>Structured capture of all TS information (no free text choices).</p>
          </div>
        </div>

        <form id="caseForm" class="case-form">
          <!-- Card: Case ID & Press -->
          <div class="card-grid">
            <div class="panel card-section">
              <div class="card-title">Case & Press</div>
              <div class="grid cols-3 card-body">
                <div>
                  <label class="label v13">SF Case # *</label>
                  <input class="input v13" id="sfCase" required placeholder="CS-123456">
                </div>

                <!-- Press Type: Simplex / Duplex -->
                <div>
                  <label class="label v13">Press Type *</label>
                  <div class="segmented" id="segPressType">
                    <button type="button" data-value="Simplex" class="active">Simplex</button>
                    <button type="button" data-value="Duplex">Duplex</button>
                  </div>
                  <input type="hidden" id="pressType" value="Simplex">
                </div>

                <!-- Press Name (Sxx / Dxx לפי הרשימה) -->
                <div>
                  <label class="label v13">Press Name *</label>
                  <div id="dd-press" class="dd field-press"></div>
                </div>
              </div>
            </div>

            <!-- Card: System Path -->
            <div class="panel card-section">
              <div class="card-title">System Path</div>
              <div class="grid cols-4 card-body">
                <div>
                  <label class="label v13">System *</label>
                  <div id="dd-system" class="dd field-system"></div>
                </div>
                <div>
                  <label class="label v13">Sub System</label>
                  <div id="dd-subsystem" class="dd field-subsystem"></div>
                </div>
                <div>
                  <label class="label v13">HW / SW / EC</label>
                  <div id="dd-hw-sw-ec" class="dd field-hwswec"></div>
                </div>
                <div>
                  <label class="label v13">Area</label>
                  <div id="dd-area" class="dd field-area"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Card: Issue -->
          <div class="panel card-section">
            <div class="card-title">Issue</div>
            <div class="grid cols-2 card-body">
              <div>
                <label class="label v13">Subject *</label>
                <input class="input v13" id="subject" maxlength="140" placeholder="Short summary of the issue">
              </div>
              <div>
                <label class="label v13">Case Date</label>
                <input class="input v13" type="date" id="caseDate">
              </div>
              <div class="full">
                <label class="label v13">Description *</label>
                <textarea class="input v13" id="description" rows="4" placeholder="Detailed description"></textarea>
              </div>
            </div>
          </div>

          <!-- Card: Troubleshooting -->
          <div class="panel card-section">
            <div class="card-title">Troubleshooting Steps</div>
            <div class="card-body">
              <div id="tsSteps" class="ts-steps"></div>
              <button type="button" class="btn small" id="btnAddStep">+ Add step</button>
            </div>
          </div>

          <!-- Card: Parts -->
          <div class="panel card-section">
            <div class="card-title">Parts</div>
            <div class="card-body">
              <div class="grid cols-3">
                <div class="full">
                  <label class="label v13">Select Part</label>
                  <div id="dd-part" class="dd field-part"></div>
                  <div class="part-desc" id="partDesc"></div>
                </div>
              </div>
              <div class="part-list" id="partList"></div>
            </div>
          </div>

          <!-- Card: Attachments & Meta -->
          <div class="card-grid">
            <div class="panel card-section">
              <div class="card-title">Attachments</div>
              <div class="card-body">
                <div id="attachList" class="attach-list"></div>
                <div class="attach-input-row">
                  <input class="input v13" id="attachInput" placeholder="Paste link or file name">
                  <button type="button" class="btn small" id="btnAddAttachment">Add</button>
                </div>
              </div>
            </div>

            <div class="panel card-section">
              <div class="card-title">Metadata</div>
              <div class="card-body">
                <div class="grid cols-2">
                  <div>
                    <label class="label v13">Region</label>
                    <div id="dd-region" class="dd field-region"></div>
                  </div>
                  <div>
                    <label class="label v13">Owner</label>
                    <input class="input v13" id="owner" placeholder="TS owner">
                  </div>
                  <div class="full">
                    <label class="label v13">Tags</label>
                    <input class="input v13" id="tags" placeholder="Comma separated">
                  </div>
                  <div class="full">
                    <label class="label v13">Notes</label>
                    <textarea class="input v13" id="notes" rows="3"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="actions">
            <button class="btn primary" type="submit">Save Case</button>
            <button class="btn ghost" type="button" id="btnResetCaseForm">Clear</button>
          </div>
        </form>
      </section>

      <!-- ========== ALL CASES ========== -->
      <section id="page-cases" class="page hidden">
        <!-- נבנה ע"י js/cases.js -->
      </section>

      <!-- ========== ROOT CAUSE (נשאיר בסיס, נשדרג אחר כך) ========== -->
      <section id="page-diagnosis" class="page hidden">
        <!-- נבנה ע"י js/rca.js -->
      </section>

      <!-- ========== SETTINGS ========== -->
      <section id="page-settings" class="page hidden">
        <div class="page-header">
          <div>
            <h2>Settings</h2>
            <p>Workspace preferences & data utilities.</p>
          </div>
        </div>

        <div class="grid cols-2">
          <div class="panel">
            <div class="title">Appearance</div>
            <div class="settings-row">
              <span>Theme</span>
              <button class="btn small" id="btnToggleTheme">Toggle Dark / Light</button>
            </div>
            <div class="settings-row">
              <span>Density</span>
              <button class="btn small" id="btnToggleDensity">Toggle Compact Mode</button>
            </div>
          </div>

          <div class="panel">
            <div class="title">Data Management</div>
            <div class="settings-row">
              <span>Export Cases</span>
              <button class="btn small" id="btnExportCases">Download JSON</button>
            </div>
            <div class="settings-row">
              <span>Import Cases</span>
              <label class="file-input-label">
                <input type="file" id="inputImportCases" accept="application/json">
                <span class="btn small">Choose File</span>
              </label>
            </div>
            <div class="settings-row">
              <span>Clear All Cases</span>
              <button class="btn small danger" id="btnClearCases">Clear Storage</button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
</div>

<!-- DATA -->
<script src="data/press-map.js"></script>
<script src="data/systems.js"></script>
<script src="data/parts.js"></script>
<script src="data/rca-data.js"></script>

<!-- CORE APP -->
<script src="app.js"></script>

<!-- CASES & RCA -->
<script src="js/cases.js"></script>
<script src="js/rca.js"></script>
</body>
</html>
