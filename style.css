:root{
  --bg:#0b1016; --bg2:#0e1420; --panel:rgba(18,24,34,.6); --glass:rgba(22,30,45,.55);
  --text:#e8f0ff; --muted:#9bb0d0; --border:rgba(255,255,255,.08);
  --accent:#00aeef; --accent2:#3bd0ff; --ok:#4ade80; --err:#ff4967;
  --header:56px; --aside-w:260px; --radius:16px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  font:14px/1.45 system-ui,-apple-system,Segoe UI,Inter,Roboto,Helvetica,Arial;
  background:
    radial-gradient(1200px 600px at 10% -10%, rgba(0,174,239,.18), transparent 60%),
    radial-gradient(1000px 500px at 110% 10%, rgba(59,208,255,.15), transparent 55%),
    linear-gradient(180deg, var(--bg), var(--bg2) 60%, #0a0f15);
  animation: breathe 14s ease-in-out infinite;
}
@keyframes breathe{0%,100%{filter:brightness(1) saturate(1)}50%{filter:brightness(1.07) saturate(1.06)}}
.hidden{display:none!important}

/* Toasts */
.toast-wrap{ position:fixed; right:16px; top:calc(var(--header) + 8px); display:flex; flex-direction:column; gap:8px; z-index:110 }
.toast{
  padding:10px 12px; border-radius:10px; border:1px solid var(--border);
  background:rgba(20,26,38,.9); box-shadow:0 14px 28px rgba(0,0,0,.35);
}
.toast.ok{ border-color:rgba(74,222,128,.5) } .toast.err{ border-color:rgba(255,73,103,.6) }

/* Panels & buttons */
.panel{
  border:1px solid var(--border); border-radius:var(--radius); padding:18px;
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow:0 18px 40px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.03);
  backdrop-filter:blur(14px) saturate(1.08);
  transition:box-shadow .25s, transform .25s, border-color .25s;
}
.panel:hover{
  box-shadow:0 20px 46px rgba(0,174,239,.24), inset 0 0 0 1px rgba(59,208,255,.12);
  border-color:rgba(59,208,255,.35); transform:translateY(-1px);
}
.panel-head{display:flex;justify-content:space-between;align-items:center;gap:10px}
.title{font-weight:600;margin-bottom:6px}
.help{color:var(--muted);font-size:12.5px}

.btn{
  border:1px solid var(--border); color:var(--text);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  padding:9px 14px; border-radius:12px; cursor:pointer;
  transition:.18s transform,.18s box-shadow,.18s border-color,.18s background;
  font:inherit;
}
.btn:hover{
  transform:translateY(-1px);
  box-shadow:0 16px 38px rgba(0,0,0,.36);
  border-color:rgba(59,208,255,.45);
}
.btn.primary{
  border-color:var(--accent);
  background:linear-gradient(180deg, rgba(0,174,239,.28), rgba(0,174,239,.08));
  color:#fff;
}
.btn.small{padding:6px 11px; border-radius:9px; font-size:12.5px}
.btn.ghost{background:transparent}
.btn.danger{border-color:rgba(255,73,103,.6);color:#fff}
.btn.full{width:100%;}

/* Layout */
.header{
  position:sticky; top:0; z-index:50;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  height:var(--header); padding:8px 14px;
  background:linear-gradient(180deg, rgba(10,14,20,.9), rgba(10,14,20,.45));
  border-bottom:1px solid var(--border);
  backdrop-filter:blur(10px) saturate(1.1);
  box-shadow:0 4px 14px rgba(0,0,0,.35);
}
.header-left{display:flex;align-items:center;gap:10px}
.header-title h1{margin:0;font-size:16px;letter-spacing:.4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.badge-env{font-size:11px;color:var(--muted);border:1px solid var(--border);padding:2px 8px;border-radius:999px}
.logo-mini svg{width:28px;height:28px}

.menu-btn{display:none;align-items:center;gap:6px}
.menu-btn .bar{width:18px;height:2px;background:#cfe7ff;border-radius:3px;box-shadow:0 0 8px rgba(0,174,239,.35)}

.wrap{display:grid;grid-template-columns:var(--aside-w) 1fr;height:calc(100vh - var(--header))}
.aside{
  border-right:1px solid var(--border);
  background:linear-gradient(180deg, rgba(14,20,30,.7), rgba(14,20,30,.4));
  backdrop-filter:blur(8px);
  padding:16px 14px;
  position:sticky;top:var(--header);height:calc(100vh - var(--header));
  overflow:auto;
}
.main{padding:16px 16px 72px;overflow:auto}

/* Navigation */
.nav{display:flex;flex-direction:column;gap:8px}
.nav .item{
  display:flex;align-items:center;gap:10px;
  padding:9px 12px;border-radius:10px;
  border:1px solid var(--border);
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
  color:var(--text);text-decoration:none;opacity:.88;
  transition:.18s transform,.18s box-shadow,.18s border-color,.18s opacity;
}
.nav .item:hover{transform:translateY(-1px);box-shadow:0 14px 30px rgba(0,0,0,.35);border-color:rgba(59,208,255,.35);opacity:1}
.nav .item.active{border-color:var(--accent);box-shadow:0 0 0 1px inset rgba(59,208,255,.3),0 12px 28px rgba(0,174,239,.25)}
.nav .badge{margin-left:auto;padding:2px 8px;border-radius:999px;border:1px solid var(--border);font-size:11.5px;color:var(--muted)}

.page.hidden{display:none}

/* Grid */
.grid{display:grid;gap:12px}
.grid.cols-2{grid-template-columns:1fr 1fr}
.grid.cols-3{grid-template-columns:repeat(3,1fr)}
.grid.cols-1{grid-template-columns:1fr}

/* Login */
#loginPage{
  display:flex;align-items:center;justify-content:center;
  min-height:100vh;padding:24px;
}
.auth{width:min(460px,92vw)}
.logo{display:flex;flex-direction:column;align-items:center;gap:8px;margin-bottom:14px}
.logo svg{height:80px;filter:drop-shadow(0 0 16px rgba(0,174,239,.4))}
.logo .subtitle{color:var(--muted);font-size:12.5px;letter-spacing:.6px;text-transform:uppercase}

.label{display:block;color:var(--muted);margin:6px 2px 4px;font-size:12.8px}
.label-inline{margin-left:4px;font-size:12.5px;color:var(--muted)}
.input,.file,textarea{
  width:100%;padding:9px 11px;border-radius:10px;
  border:1px solid var(--border);
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.015));
  color:var(--text);outline:none;
}
textarea{min-height:80px;resize:vertical}
.sep{border:0;border-top:1px solid var(--border);margin:10px 0}
.full{grid-column:1 / -1}
.inline{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.fit-inline{display:inline-flex;align-items:center;gap:6px;flex-wrap:wrap}

/* Chips */
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{
  padding:6px 10px;border-radius:999px;
  border:1px solid var(--border);cursor:pointer;
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.015));
  user-select:none;font-size:12.5px;
}
.chip.active{
  border-color:rgba(0,174,239,.7);
  background:linear-gradient(180deg, rgba(0,174,239,.3), rgba(0,174,239,.09));
}

/* Dropdown */
.dd{position:relative;display:inline-block;width:100%}
.dd-btn{
  width:100%;padding:9px 34px 9px 11px;border-radius:10px;
  border:1px solid var(--border);background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.01));
  color:var(--text);text-align:left;cursor:pointer;
}
.dd-label{pointer-events:none}
.dd-arrow{
  position:absolute;right:9px;top:50%;transform:translateY(-50%);
  width:15px;height:15px;pointer-events:none;
  background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23cfe7ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E") center/15px 15px no-repeat;
}
.dd-list{
  position:absolute;left:0;right:0;top:calc(100% + 6px);
  max-height:260px;overflow:auto;
  border-radius:12px;border:1px solid var(--border);
  background:linear-gradient(180deg, rgba(18,24,34,.97), rgba(18,24,34,.9));
  box-shadow:0 22px 60px rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,.03);
  padding:6px 0;display:none;z-index:30;
}
.dd.open .dd-list{display:block}
.dd-item{padding:7px 11px;font-size:13px;cursor:pointer;display:flex;gap:6px;align-items:center}
.dd-item:hover{background:rgba(59,208,255,.14)}
.dd-item[aria-selected="true"]::before{
  content:"";width:8px;height:8px;border-radius:2px;
  background:linear-gradient(180deg,var(--accent),var(--accent2));
  box-shadow:0 0 10px rgba(0,174,239,.5);
}
.dd-empty{padding:8px 11px;color:var(--muted);font-size:12.5px}

/* Case form tweaks */
.field-sf{max-width:180px}
.field-sw{max-width:160px}
.field-press{max-width:260px}
.field-system{max-width:260px}
.field-subsystem{max-width:260px}
.field-category{max-width:240px}
.field-item{max-width:260px}
.field-wide{max-width:100%}
.field-troubles{max-width:560px}

.partwrap{position:relative}
.part-suggest{
  position:absolute;left:0;right:0;top:100%;
  background:rgba(10,14,22,.98);
  border-radius:10px;border:1px solid var(--border);
  max-height:220px;overflow:auto;display:none;z-index:25;
}
.part-suggest div{padding:6px 10px;font-size:12.8px;cursor:pointer}
.part-suggest div:hover{background:rgba(59,208,255,.18)}

.solution-meta{margin-top:6px;font-size:12.5px;color:var(--muted)}
.sol-version-wrap{margin-top:4px}

/* Cases list */
.case-card{
  border:1px solid var(--border);border-radius:14px;padding:12px;
  display:grid;grid-template-columns:auto 1fr auto;gap:10px;
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  box-shadow:0 14px 34px rgba(0,0,0,.32), inset 0 0 0 1px rgba(255,255,255,.03);
}
.case-card .stripe{width:5px;border-radius:8px;background:linear-gradient(180deg,var(--accent),var(--accent2))}
.case-card .title{font-weight:600}
.case-card .meta{color:var(--muted);font-size:12.5px;display:flex;flex-wrap:wrap;gap:8px}
.case-card .kv{display:flex;gap:4px}
.case-card .k{color:var(--muted)}
.case-card .v{color:var(--text)}
.case-card .files{color:var(--muted);font-size:12.3px;margin-top:3px}

/* Dashboard mini lists */
.mini-list{font-size:12.8px;display:flex;flex-direction:column;gap:4px;margin-top:4px}
.mini-row{display:flex;justify-content:space-between;gap:8px}
.mini-label{color:var(--muted)}
.mini-value{font-variant-numeric:tabular-nums}

/* KPIs */
.kpi-main{font-size:26px;margin-top:4px}
.kpi-subgrid{display:grid;grid-template-columns:1fr 1fr;gap:4px;margin-top:6px}
.kpi-label{color:var(--muted);font-size:12.3px}

/* FAB */
.fab{position:fixed;left:16px;bottom:18px;z-index:40}
.fab .btn{box-shadow:0 18px 40px rgba(0,174,239,.35);border-radius:20px}

/* Modal */
.modal-back{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:none;align-items:center;justify-content:center;z-index:90;
}
.modal{
  width:min(880px,94vw);max-height:88vh;overflow:auto;
  border-radius:16px;border:1px solid var(--border);padding:18px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.025));
  box-shadow:0 30px 80px rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,.03);
}
.modal-head{display:flex;justify-content:space-between;align-items:center;gap:10px}

/* Wizard */
.wizard-stepper{
  position:relative;
  display:flex;gap:12px;margin:4px 0 16px;align-items:flex-start;
}
.wizard-step{position:relative;z-index:2;display:flex;flex-direction:column;align-items:flex-start;gap:3px;font-size:12px;color:var(--muted)}
.wizard-step .bubble{
  width:22px;height:22px;border-radius:999px;border:1px solid var(--border);
  display:flex;align-items:center;justify-content:center;
  background:rgba(10,16,24,.95);
}
.wizard-step.active .bubble{
  border-color:var(--accent);
  background:linear-gradient(180deg, rgba(0,174,239,.3), rgba(0,174,239,.1));
}
.wizard-step.completed .bubble{
  border-color:var(--ok);background:rgba(34,197,94,.22);
}
.wizard-track{
  position:absolute;left:16px;right:16px;bottom:9px;height:3px;
  border-radius:999px;background:rgba(255,255,255,.06);overflow:hidden;
}
.wizard-track-fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  transition:width .25s ease;
}

.wizard-layout{
  display:grid;grid-template-columns:minmax(0,2.5fr) minmax(0,1fr);gap:14px;align-items:flex-start;
}
.wizard-main{display:flex;flex-direction:column;gap:10px}
.wizard-card{
  border-radius:14px;border:1px solid var(--border);padding:14px;
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
}
.wizard-side{display:flex;flex-direction:column;gap:10px}
.wizard-side .panel.slim{padding:12px}

.issue-grid{display:flex;flex-wrap:wrap;gap:10px;margin-top:6px}
.issue-pill{
  border-radius:14px;border:1px solid var(--border);padding:9px 11px;
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
  cursor:pointer;min-width:160px;text-align:left;
}
.issue-pill .pill-title{font-weight:600}
.issue-pill .pill-sub{font-size:12px;color:var(--muted);margin-top:2px}
.issue-pill.active{
  border-color:var(--accent);
  background:linear-gradient(180deg, rgba(0,174,239,.28), rgba(0,174,239,.08));
}

.ird-grid{display:flex;flex-direction:column;gap:6px;margin-top:6px}
.ird-row{
  display:grid;grid-template-columns:minmax(0,1.8fr) 1fr 1.2fr auto;gap:6px;align-items:center;
}
.ird-label{font-size:13px}
.ird-spec{font-size:12px;color:var(--muted)}
.ird-status{font-size:11.5px}
.ird-status.ok{color:var(--ok)}
.ird-status.out{color:var(--err)}

.diag-summary{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.diag-card{
  border-radius:12px;border:1px solid var(--border);padding:10px;
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
  font-size:13px;
}
.diag-card strong{display:block;margin-bottom:4px}
.tips{margin:6px 0 0;padding-left:18px;font-size:12.5px;color:var(--muted)}
.tips li{margin:2px 0}

.wizard-footer{
  margin-top:12px;display:flex;align-items:center;gap:8px;
}
.wizard-footer .spacer{flex:1}

/* Dashboard QA */
.dashboard-qa .qa-grid{
  display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;
}

/* Particles canvas */
#particles{position:fixed;inset:0;z-index:-1;pointer-events:none}

/* Responsive */
@media (max-width:1100px){
  .grid.cols-3{grid-template-columns:1fr 1fr}
  .wizard-layout{grid-template-columns:1fr}
}
@media (max-width:780px){
  .wrap{grid-template-columns:1fr}
  .aside{
    position:fixed;top:var(--header);left:0;bottom:0;width:min(82vw,320px);
    transform:translateX(-105%);transition:transform .25s ease;
    box-shadow:16px 0 40px rgba(0,0,0,.45);height:auto;
  }
  body.aside-open .aside{transform:translateX(0)}
  .menu-btn{display:flex}
  .main{padding:14px 12px 80px}
  .grid.cols-2,.grid.cols-3{grid-template-columns:1fr}
}
